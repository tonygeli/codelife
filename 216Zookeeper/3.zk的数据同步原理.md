# ZK的数据同步原理

- peerLastZxid:Learner服务器（Follower或Observer）最后处理的zxid
- minCommittedLog:Leader服务器proposal缓存队列committedLog中最小的zxid
- maxCommittedLog:Leader服务器proposal缓存队列committedLog中最大的zxid

ZK中数据同步一共有四类：

- DIFF：直接差异化同步 peerLastZxid介于minCommittedLog和maxCommittedLog

- TRUNC+DIFF：先回滚再差异化同步
- TRUNC 仅回滚同步 peerLastZxid大于maxCommittedLog，Leader会要求Learner回滚到ZXID值为maxCommittedLog对应的事务操作
- SNAP 全量同步 peerLastZxid小于minCommittedLog



