# RabbitMq

## 一、Docker安装

### 拉取镜像

```
docker pull docker.io/macintoshplus/rabbitmq-management
```

### 运行镜像

```
docker run -d --hostname my-rabbit --name rabbit -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin -p 15672:15672 -p 5672:5672 -p 25672:25672 -p 61613:61613 -p 1883:1883 rabbitmq:management
```

-e RABBITMQ_DEFAULT_USER=admin 默认用户名

-e RABBITMQ_DEFAULT_PASS=admin 默认密码

http://localhost:15672  访问地址+端口

### 查看rabbitmq运行状况

```
docker logs rabbit


2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  node           : rabbit@my-rabbit
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  home dir       : /var/lib/rabbitmq
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  config file(s) : /etc/rabbitmq/conf.d/10-default-guest-user.conf
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  cookie hash    : 9RiYHrEtDfFYMX2hWoP1/A==
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  log(s)         : /var/log/rabbitmq/rabbit@my-rabbit_upgrade.log
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>                 : <stdout>
2021-11-11 09:32:53.479856+00:00 [info] <0.222.0>  database dir   : /var/lib/rabbitmq/mnesia/rabbit@my-rabbit
```

## 二、支持消息的模式

> https://rabbitmq.com/getstarted.html

### 2.1.简单模式Simple

### 2.2.工作模式[Work queues](https://rabbitmq.com/tutorials/tutorial-two-python.html)

![img](../../images/python-two.png)

### 2.3.发布订阅模式fanout

![img](../../images/python-three.png)

fanout-发布订阅模式，是一种广播机制，它没有路由key的模式

### 2.4.路由模式direct

![img](../../images/python-four.png)

有routing-key的匹配模式

### 2.5.主题Topic模式topic

![img](../../images/python-five.png)

模糊的routing-key的匹配模式

### 2.6.参数模式

类型：headers

特点：参数匹配模式







轮训分发

公平分发：需要手动应答，能者多劳

```java
finalChannel.basicQos(1); 	// 一次取多少条数据

finalChannel.basicConsume("queue", false)
```





